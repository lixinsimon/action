webpackJsonp([0,2],[,function(t,i,e){e(5);var s=e(0)(e(3),e(8),null,null);t.exports=s.exports},,function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s=e(7),n=e.n(s);i.default={name:"app",data:function(){return{imgsArr:[],fetchImgsArr:[]}},components:{vueWaterfallEasy:n.a},methods:{initImgsArr:function(t,i){for(var e=[],s=t;s<i;s++)e.push({src:"./static/img/"+(s+1)+".jpg",link:"https://www.baidu.com",info:"一些图片描述文字"});return e},fetchImgsData:function(){this.imgsArr=this.imgsArr.concat(this.fetchImgsArr)}},created:function(){this.imgsArr=this.initImgsArr(0,10),this.fetchImgsArr=this.initImgsArr(10,20)}}},function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default={name:"vue-waterfall-easy",props:{gap:{type:Number,default:20},maxCols:{type:Number,default:5},imgsArr:{type:Array,required:!0},imgWidth:{type:Number,default:240},timeOut:{type:Number,default:500}},data:function(){return{msg:"this is from vue-waterfall-easy.vue",columnCount:NaN,isMobile:navigator.userAgent.match(/(iPhone|iPod|Android|ios)/i),beginIndex:NaN,colsHeightArr:[],imgBoxEls:null,isPreloading:!0,isPreloadingC:!0,imgsArrC:[],loadedCount:0,isFirstTIme:!0}},computed:{colWidth:function(){return this.imgWidth+this.gap},imgWidthC:function(){return this.isMobile?window.innerWidth/2-this.gap:this.imgWidth}},methods:{waterfall:function(){for(var t=this.beginIndex;t<this.imgsArr.length;t++){var i=Math.min.apply(null,this.colsHeightArr),e=this.colsHeightArr.indexOf(i),s=this.imgBoxEls[0].offsetWidth;this.imgBoxEls[t].style.position="absolute",this.imgBoxEls[t].style.left=e*s+"px",this.imgBoxEls[t].style.top=i+"px",this.$set(this.colsHeightArr,e,i+this.imgBoxEls[t].offsetHeight)}this.beginIndex=this.imgsArr.length},loadFn:function(t,i,e){var s=this;this.loadedCount++,"load"===t.type&&this.$set(this.imgsArr[e],"height",Math.round(this.imgWidthC/(i.width/i.height))),this.loadedCount===this.imgsArr.length&&(this.imgsArrC=this.imgsArr.concat([]),this.isPreloading=!1,this.isFirstTIme=!1,this.$nextTick(function(){s.initImgBoxEls(),s.$emit("preloaded")}))},preload:function(){var t=this;this.imgsArr.forEach(function(i,e){if(!(e<t.loadedCount)){var s=new Image;s.addEventListener("load",function(i){t.loadFn(i,s,e)}),s.src=i.src}})},initColsHeightArr:function(){this.colsHeightArr=[];for(var t=0;t<this.columnCount;t++){this.imgBoxEls[t].style.position="static";var i=this.imgBoxEls[t].offsetHeight;this.colsHeightArr.push(i)}},initImgBoxEls:function(){this.imgBoxEls=document.getElementsByClassName("img-box")},initColumnCount:function(){var t=window.innerWidth,i=parseInt(t/this.colWidth);i=0===i?1:i,this.columnCount=this.isMobile?2:i>this.maxCols?this.maxCols:i}},mounted:function(){var t=this;this.initColumnCount(),this.beginIndex=this.columnCount,this.preload(),this.$on("preloaded",function(){0===t.colsHeightArr.length&&t.initColsHeightArr(),t.waterfall()}),window.addEventListener("resize",function(){var i=t.columnCount;t.initColumnCount(),i!==t.columnCount&&(t.beginIndex=t.columnCount,t.initColsHeightArr(),t.waterfall())}),console.log(this.$el.parentNode),console.log(this.$el.parentNode,this.$el.parentNode.scrollTop+this.$el.parentNode.offsetHeight,this.$el.parentNode.scrollHeight),this.$el.parentNode.addEventListener("scroll",function(){if(!t.isPreloading){var i=t.imgsArr[t.imgsArr.length-1].height;console.log(t.$el.parentNode,t.$el.parentNode.scrollTop+t.$el.parentNode.offsetHeight,t.$el.parentNode.scrollHeight),t.$el.parentNode.scrollTop+t.$el.parentNode.offsetHeight>t.$el.parentNode.scrollHeight-i&&t.$emit("scrollLoadImg")}})},watch:{imgsArr:function(t,i){t.length!==i.length&&(this.isPreloading=!0,this.preload())},isPreloading:function(t){var i=this;t?setTimeout(function(){i.isPreloading&&(i.isPreloadingC=!0)},this.timeOut):this.isPreloadingC=!1}}}},function(t,i){},function(t,i){},function(t,i,e){e(6);var s=e(0)(e(4),e(9),null,null);t.exports=s.exports},function(t,i){t.exports={render:function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{attrs:{id:"app"}},[e("vue-waterfall-easy",{attrs:{imgsArr:t.imgsArr},on:{scrollLoadImg:t.fetchImgsData},scopedSlots:t._u([{key:"default",fn:function(i){return[e("p",{staticClass:"some-info"},[t._v("第"+t._s(i.index+1)+"张图片")]),e("p",{staticClass:"some-info"},[t._v(t._s(i.value.info))])]}}])})],1)},staticRenderFns:[]}},function(t,i){t.exports={render:function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"vue-waterfall-easy",style:t.isMobile?"":{width:t.colWidth*t.columnCount+"px",left:"50%",marginLeft:-1*t.colWidth*t.columnCount/2+"px"}},[t._l(t.imgsArrC,function(i,s){return e("a",{staticClass:"img-box",style:{padding:t.gap/2+"px",width:t.isMobile?"":t.colWidth+"px"},attrs:{href:i.link}},[e("div",{staticClass:"img-inner-box"},[e("div",{staticClass:"img-wraper",style:{width:t.imgWidthC+"px",height:i.height?i.height+"px":""}},[e("img",{attrs:{src:i.src}})]),e("div",{staticClass:"img-info"},[t._t("default",null,{index:s,value:i})],2)])])}),t.isPreloadingC?e("div",{staticClass:"loading",class:{"first-loading":t.isFirstTIme}},[e("div",{staticClass:"double-bounce1"}),e("div",{staticClass:"double-bounce2"})]):t._e()],2)},staticRenderFns:[]}},,,function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s=e(2),n=e.n(s),o=e(1),r=e.n(o);new n.a({el:"#app",template:"<App/>",components:{App:r.a}})}],[12]);
//# sourceMappingURL=app.2b061490a6f8a954b207.js.map